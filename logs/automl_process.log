2023-03-31 17:29:43,961 automl_tabular main.py main set_logger INFO: logger 세팅
2023-03-31 17:29:43,961 automl_tabular input_data.py input_data read_data INFO: csv 데이터 불러오기
2023-03-31 17:29:43,961 automl_tabular input_data.py input_data read_data INFO: storage/data/churn.csv
2023-03-31 17:29:43,974 automl_tabular input_data.py input_data read_data INFO: 변수 분리 시작
2023-03-31 17:29:43,978 automl_tabular check_reduce.py check_reduce data_check INFO: 데이터 정합성 확인 절차 시작
2023-03-31 17:29:43,980 automl_tabular check_reduce.py check_reduce data_check INFO: 데이터 정합성 확인 절차 종료
2023-03-31 17:29:43,980 automl_tabular check_reduce.py check_reduce data_check INFO: 데이터 정합성 확인 절차 결과 : True
2023-03-31 17:29:43,982 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: 데이터 구성: 3333 행, 21열
2023-03-31 17:29:43,983 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: Memory usage of dataframe is 0.51MB
2023-03-31 17:29:43,999 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: Memory usage after optimization is: 0.27MB
2023-03-31 17:29:43,999 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: Decreased by 48.1%
2023-03-31 17:29:43,999 automl_tabular preprocess.py preprocess na_preprocess INFO: 결측치 처리
2023-03-31 17:29:44,002 automl_tabular preprocess.py preprocess na_preprocess INFO: 결측치 처리 이후 데이터 구성: 3333 행, 21열
2023-03-31 17:29:44,002 automl_tabular preprocess.py preprocess id_target_preprocess INFO: 전처리를 위한 id와 target 분리
2023-03-31 17:29:44,005 automl_tabular preprocess.py preprocess standardize INFO: 정규화 진행
2023-03-31 17:29:44,008 automl_tabular preprocess.py preprocess label_encoder INFO: 라벨 인코딩 진행
2023-03-31 17:29:44,027 automl_tabular preprocess.py preprocess get_df INFO: 전처리 완료
2023-03-31 17:29:44,027 automl_tabular preprocess.py preprocess get_df INFO: 

2023-03-31 17:29:44,027 automl_tabular preprocess.py preprocess get_df INFO:    international_plan  phone_number  voice_mail_plan  total_day_charge  \
0                   0          1926                1          1.566206   
1                   0          1575                1         -0.334166   
2                   0          1117                0          1.167904   
3                   1          1707                0          2.197412   
4                   1           110                0         -0.239653   

   total_day_minutes  total_eve_charge  total_eve_minutes  total_intl_charge  \
0           1.564919         -0.070136          -0.071112          -0.086768   
1          -0.333276         -0.106389          -0.108089           1.240099   
2           1.167836         -1.574625          -1.573623           0.695876   
3           2.198416         -2.742869          -2.742723          -1.306086   
4          -0.239170         -1.038084          -1.039918          -0.045303   

   total_intl_minutes  total_night_charge  total_night_minutes  \
0           -0.085008            0.865064             0.867661   
1            1.241602            1.060760             1.057999   
2            0.704241           -0.755436            -0.756399   
3           -1.302466           -0.079083            -0.079089   
4           -0.048624           -0.278212            -0.276844   

   account_length  area_code  customer_service_calls  number_vmail_messages  \
0        0.676489  -0.523603               -0.427932               1.234883   
1        0.149065  -0.523603               -0.427932               1.307948   
2        0.902528  -0.523603               -1.188218              -0.591760   
3       -0.428590  -0.688834                0.332354              -0.591760   
4       -0.654629  -0.523603                1.092641              -0.591760   

   total_day_calls  total_eve_calls  total_intl_calls  total_night_calls  \
0         0.476643        -0.055940         -0.601195          -0.465494   
1         1.124503         0.144867         -0.601195           0.147825   
2         0.675985         0.496279          0.211534           0.198935   
3        -1.466936        -0.608159          1.024263          -0.567714   
4         0.626149         1.098699         -0.601195           1.067803   

  state  churn  
0    KS      0  
1    OH      0  
2    NJ      0  
3    OH      0  
4    OK      0  
2023-03-31 17:29:44,038 automl_tabular modeling.py modeling id_modeling INFO: 모델링을 위한 id 분리
2023-03-31 17:29:44,039 automl_tabular modeling.py modeling train_test_split INFO: train valid 분리
2023-03-31 17:29:44,041 automl_tabular modeling.py modeling train_test_split INFO: 불균형 처리
2023-03-31 17:29:44,053 automl_tabular modeling.py modeling train_test_split INFO: train valid 분리 후
2023-03-31 17:29:44,053 automl_tabular modeling.py modeling train_test_split INFO: X_train.shape: (4548, 19)
2023-03-31 17:29:44,053 automl_tabular modeling.py modeling train_test_split INFO: X_test.shape : (667, 19)
2023-03-31 17:29:44,053 automl_tabular modeling.py modeling train_test_split INFO: y_train.shape: (4548, 1)
2023-03-31 17:29:44,053 automl_tabular modeling.py modeling train_test_split INFO: y_test.shape : (667, 1)
2023-03-31 17:29:44,053 automl_tabular modeling.py modeling rf_fit_predict INFO: rf 모델 hpo 세팅
2023-03-31 17:29:44,054 automl_tabular modeling.py modeling rf_fit_predict INFO: 세팅된 parameters : {'n_estimators': 10, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}
2023-03-31 17:29:44,054 automl_tabular modeling.py modeling rf_fit_predict INFO: rf 모델 fitting
2023-03-31 17:29:44,194 automl_tabular modeling.py modeling lgb_fit_predict INFO: lgbm 모델 hpo 세팅
2023-03-31 17:29:44,195 automl_tabular modeling.py modeling lgb_fit_predict INFO: 세팅된 parameters : {'num_leaves': [60], 'min_child_samples': [10], 'max_depth': [5], 'learning_rate': [0.1], 'reg_alpha': [0.01]}
2023-03-31 17:29:44,195 automl_tabular modeling.py modeling lgb_fit_predict INFO: lgbm 모델 fitting
2023-03-31 17:29:44,358 automl_tabular modeling.py modeling get_tabnet_param INFO: tabnet params 세팅
2023-03-31 17:29:44,361 automl_tabular modeling.py modeling get_tabnet_param INFO: tabnet_param : {'cat_idxs': [0, 1, 2], 'cat_dims': [2, 3333, 2]}
2023-03-31 17:29:44,362 automl_tabular modeling.py modeling get_tabnet_param INFO: tabnet params를 object storage에 저장
2023-03-31 17:29:44,364 automl_tabular modeling.py modeling tab_fit_predict INFO: tabnet 모델 세팅
2023-03-31 17:29:44,364 automl_tabular modeling.py modeling tab_fit_predict INFO: 세팅된 parameters : {'mask_type': 'entmax', 'n_da': 8, 'n_steps': 3, 'gamma': 1.3, 'n_shared': 2, 'lambda_sparse': 0.001, 'patience': 10, 'epochs': 2}
2023-03-31 17:29:44,364 automl_tabular modeling.py modeling tab_fit_predict INFO: tabnet 모델 fitting
2023-03-31 17:30:14,721 automl_tabular modeling.py modeling get_best_model INFO: Auto ML 가동
2023-03-31 17:30:14,722 automl_tabular modeling.py modeling get_best_model INFO: automl_score:{'AUROC': {'rf': 0.905, 'lgb': 0.941, 'tab': 0.687}, 'AUCPR': {'rf': 0.694, 'lgb': 0.872, 'tab': 0.305}, '정확도': {'rf': 0.918, 'lgb': 0.951, 'tab': 0.328}, '정밀도': {'rf': 0.705, 'lgb': 0.815, 'tab': 0.161}, '재현율': {'rf': 0.681, 'lgb': 0.824, 'tab': 0.934}, 'F1': {'rf': 0.693, 'lgb': 0.82, 'tab': 0.275}}
2023-03-31 17:30:14,722 automl_tabular modeling.py modeling get_best_model INFO: best_model_name: lgb
2023-03-31 17:30:14,722 automl_tabular modeling.py modeling get_best_model INFO: best 모델 저장
2023-03-31 17:30:14,732 automl_tabular modeling.py modeling make_report INFO: 학습 결과를 위한 결과물 생성
2023-03-31 17:30:14,734 automl_tabular modeling.py modeling get_eval INFO: best 모델 검증
2023-03-31 17:30:14,739 automl_tabular modeling.py modeling get_eval INFO: 오차행렬 
 : [[559  17]
 [ 16  75]]
2023-03-31 17:30:14,740 automl_tabular modeling.py modeling get_eval INFO: 정확도 : 0.9505247376311844
2023-03-31 17:30:14,740 automl_tabular modeling.py modeling get_eval INFO: 정밀도 : 0.8152173913043478
2023-03-31 17:30:14,742 automl_tabular modeling.py modeling get_eval INFO: 재현율 : 0.8241758241758241
2023-03-31 17:30:14,743 automl_tabular modeling.py modeling get_eval INFO: f1 score : 0.8196721311475409
2023-03-31 17:30:14,745 automl_tabular modeling.py modeling get_eval INFO: roc auc score : 0.9413347069597069
2023-03-31 17:30:14,751 automl_tabular modeling.py modeling get_eval INFO: 모델별 학습 결과표 생성
2023-03-31 17:30:14,753 automl_tabular modeling.py modeling get_eval INFO: 변수 중요도 저장
