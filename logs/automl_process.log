2023-03-28 16:17:48,516 automl_tabular main.py main set_logger INFO: logger 세팅
2023-03-28 16:17:48,516 automl_tabular input_data.py input_data read_data INFO: csv 데이터 불러오기
2023-03-28 16:17:48,517 automl_tabular input_data.py input_data read_data INFO: storage/data/churn.csv
2023-03-28 16:17:48,525 automl_tabular input_data.py input_data read_data INFO: 변수 분리 시작
2023-03-28 16:17:48,527 automl_tabular check_reduce.py check_reduce data_check INFO: 데이터 정합성 확인 절차 시작
2023-03-28 16:17:48,527 automl_tabular check_reduce.py check_reduce data_check INFO: 데이터 정합성 확인 절차 종료
2023-03-28 16:17:48,528 automl_tabular check_reduce.py check_reduce data_check INFO: 데이터 정합성 확인 절차 결과 : True
2023-03-28 16:17:48,528 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: 데이터 구성: 3333 행, 21열
2023-03-28 16:17:48,529 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: Memory usage of dataframe is 0.51MB
2023-03-28 16:17:48,537 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: Memory usage after optimization is: 0.27MB
2023-03-28 16:17:48,537 automl_tabular check_reduce.py check_reduce reduce_mem_usage INFO: Decreased by 48.1%
2023-03-28 16:17:48,537 automl_tabular preprocess.py preprocess na_preprocess INFO: 결측치 처리
2023-03-28 16:17:48,540 automl_tabular preprocess.py preprocess na_preprocess INFO: 결측치 처리 이후 데이터 구성: 3333 행, 21열
2023-03-28 16:17:48,540 automl_tabular preprocess.py preprocess id_target_preprocess INFO: 전처리를 위한 id와 target 분리
2023-03-28 16:17:48,545 automl_tabular preprocess.py preprocess standardize INFO: 정규화 진행
2023-03-28 16:17:48,548 automl_tabular preprocess.py preprocess label_encoder INFO: 라벨 인코딩 진행
2023-03-28 16:17:48,557 automl_tabular preprocess.py preprocess get_df INFO: 전처리 완료
2023-03-28 16:17:48,557 automl_tabular preprocess.py preprocess get_df INFO: 

2023-03-28 16:17:48,557 automl_tabular preprocess.py preprocess get_df INFO:    phone_number  international_plan  voice_mail_plan  total_day_minutes  \
0          1926                   0                1           1.564919   
1          1575                   0                1          -0.333276   
2          1117                   0                0           1.167836   
3          1707                   1                0           2.198416   
4           110                   1                0          -0.239170   

   total_day_charge  total_eve_minutes  total_eve_charge  total_night_minutes  \
0          1.566206          -0.071112         -0.070136             0.867661   
1         -0.334166          -0.108089         -0.106389             1.057999   
2          1.167904          -1.573623         -1.574625            -0.756399   
3          2.197412          -2.742723         -2.742869            -0.079089   
4         -0.239653          -1.039918         -1.038084            -0.276844   

   total_night_charge  total_intl_minutes  total_intl_charge  account_length  \
0            0.865064           -0.085008          -0.086768        0.676489   
1            1.060760            1.241602           1.240099        0.149065   
2           -0.755436            0.704241           0.695876        0.902528   
3           -0.079083           -1.302466          -1.306086       -0.428590   
4           -0.278212           -0.048624          -0.045303       -0.654629   

   area_code  number_vmail_messages  total_day_calls  total_eve_calls  \
0  -0.523603               1.234883         0.476643        -0.055940   
1  -0.523603               1.307948         1.124503         0.144867   
2  -0.523603              -0.591760         0.675985         0.496279   
3  -0.688834              -0.591760        -1.466936        -0.608159   
4  -0.523603              -0.591760         0.626149         1.098699   

   total_night_calls  total_intl_calls  customer_service_calls state  churn  
0          -0.465494         -0.601195               -0.427932    KS      0  
1           0.147825         -0.601195               -0.427932    OH      0  
2           0.198935          0.211534               -1.188218    NJ      0  
3          -0.567714          1.024263                0.332354    OH      0  
4           1.067803         -0.601195                1.092641    OK      0  
2023-03-28 16:17:48,565 automl_tabular modeling.py modeling id_modeling INFO: 모델링을 위한 id 분리
2023-03-28 16:17:48,566 automl_tabular modeling.py modeling train_test_split INFO: train valid 분리
2023-03-28 16:17:48,568 automl_tabular modeling.py modeling train_test_split INFO: 불균형 처리
2023-03-28 16:17:48,576 automl_tabular modeling.py modeling train_test_split INFO: train valid 분리 후
2023-03-28 16:17:48,577 automl_tabular modeling.py modeling train_test_split INFO: X_train.shape: (4548, 19)
2023-03-28 16:17:48,577 automl_tabular modeling.py modeling train_test_split INFO: X_test.shape : (667, 19)
2023-03-28 16:17:48,577 automl_tabular modeling.py modeling train_test_split INFO: y_train.shape: (4548, 1)
2023-03-28 16:17:48,577 automl_tabular modeling.py modeling train_test_split INFO: y_test.shape : (667, 1)
2023-03-28 16:17:48,577 automl_tabular modeling.py modeling lr_fit_predict INFO: lr 모델 hpo 세팅
2023-03-28 16:17:48,578 automl_tabular modeling.py modeling lr_fit_predict INFO: 세팅된 parameters : {'C': 1.0, 'class_weight': None, 'solver': 'lbfgs', 'max_iter': 5000}
2023-03-28 16:17:48,578 automl_tabular modeling.py modeling lr_fit_predict INFO: lr 모델 fitting
2023-03-28 16:17:48,762 automl_tabular modeling.py modeling rf_fit_predict INFO: rf 모델 hpo 세팅
2023-03-28 16:17:48,762 automl_tabular modeling.py modeling rf_fit_predict INFO: 세팅된 parameters : {'n_estimators': 10, 'max_depth': None, 'min_samples_split': 2, 'min_samples_leaf': 1}
2023-03-28 16:17:48,762 automl_tabular modeling.py modeling rf_fit_predict INFO: rf 모델 fitting
2023-03-28 16:17:48,840 automl_tabular modeling.py modeling lgb_fit_predict INFO: lgbm 모델 hpo 세팅
2023-03-28 16:17:48,840 automl_tabular modeling.py modeling lgb_fit_predict INFO: 세팅된 parameters : {'num_leaves': [60], 'min_child_samples': [10], 'max_depth': [5], 'learning_rate': [0.1], 'reg_alpha': [0.01]}
2023-03-28 16:17:48,840 automl_tabular modeling.py modeling lgb_fit_predict INFO: lgbm 모델 fitting
2023-03-28 16:17:48,930 automl_tabular modeling.py modeling get_tabnet_param INFO: tabnet params 세팅
2023-03-28 16:17:48,933 automl_tabular modeling.py modeling get_tabnet_param INFO: tabnet_param : {'cat_idxs': [0, 1, 2], 'cat_dims': [3333, 2, 2]}
2023-03-28 16:17:48,933 automl_tabular modeling.py modeling get_tabnet_param INFO: tabnet params를 object storage에 저장
2023-03-28 16:17:48,935 automl_tabular modeling.py modeling tab_fit_predict INFO: tabnet 모델 세팅
2023-03-28 16:17:48,935 automl_tabular modeling.py modeling tab_fit_predict INFO: 세팅된 parameters : {'mask_type': 'entmax', 'n_da': 8, 'n_steps': 3, 'gamma': 1.3, 'n_shared': 2, 'lambda_sparse': 0.001, 'patience': 10, 'epochs': 2}
2023-03-28 16:17:48,935 automl_tabular modeling.py modeling tab_fit_predict INFO: tabnet 모델 fitting
2023-03-28 16:18:17,193 automl_tabular modeling.py modeling get_best_model INFO: Auto ML 가동
2023-03-28 16:18:17,194 automl_tabular modeling.py modeling get_best_model INFO: automl_score:{'AUROC': {'lr': 0.829, 'rf': 0.891, 'lgb': 0.941, 'tab': 0.708}, 'AUCPR': {'lr': 0.475, 'rf': 0.67, 'lgb': 0.872, 'tab': 0.326}, '정확도': {'lr': 0.757, 'rf': 0.906, 'lgb': 0.951, 'tab': 0.367}, '정밀도': {'lr': 0.333, 'rf': 0.663, 'lgb': 0.815, 'tab': 0.164}, '재현율': {'lr': 0.78, 'rf': 0.626, 'lgb': 0.824, 'tab': 0.89}, 'F1': {'lr': 0.467, 'rf': 0.644, 'lgb': 0.82, 'tab': 0.277}}
2023-03-28 16:18:17,194 automl_tabular modeling.py modeling get_best_model INFO: best_model_name: lgb
2023-03-28 16:18:17,194 automl_tabular modeling.py modeling get_best_model INFO: best 모델 저장
2023-03-28 16:18:17,203 automl_tabular modeling.py modeling make_report INFO: 학습 결과를 위한 결과물 생성
2023-03-28 16:18:17,205 automl_tabular modeling.py modeling get_eval INFO: best 모델 검증
2023-03-28 16:18:17,211 automl_tabular modeling.py modeling get_eval INFO: 오차행렬 
 : [[559  17]
 [ 16  75]]
2023-03-28 16:18:17,211 automl_tabular modeling.py modeling get_eval INFO: 정확도 : 0.9505247376311844
2023-03-28 16:18:17,212 automl_tabular modeling.py modeling get_eval INFO: 정밀도 : 0.8152173913043478
2023-03-28 16:18:17,213 automl_tabular modeling.py modeling get_eval INFO: 재현율 : 0.8241758241758241
2023-03-28 16:18:17,214 automl_tabular modeling.py modeling get_eval INFO: f1 score : 0.8196721311475409
2023-03-28 16:18:17,215 automl_tabular modeling.py modeling get_eval INFO: roc auc score : 0.9412393162393162
2023-03-28 16:18:17,222 automl_tabular modeling.py modeling get_eval INFO: 모델별 학습 결과표 생성
2023-03-28 16:18:17,222 automl_tabular modeling.py modeling get_eval INFO: 변수 중요도 저장
